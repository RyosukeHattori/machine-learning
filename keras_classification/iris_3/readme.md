kerasで作った識別プログラムです。
ラベルには文字列と整数の両方に対応しています。

また、予測フェーズでは自動的に識別結果をラベルに戻してくれます。
ラベルが文字列の場合に便利です。

iris2に対して、記述を関数化して、検証結果を集計する機能とクラスに対する重み係数の計算を追加しています。
また、正規化の方法をsklearn.preprocessing.scale()を使った方法から独自に定義したscalerクラスを使うよう変更しています。
これで未知データの予測フェーズにおいて、外れ値の影響で予測がずれることを防ぎます。
さらに、一部のデータを学習に使わずに、lossの評価を行っています。lossの様子から過学習の判定が可能でしょう。
加えて、prediction.pyはデフォルトでは正解ラベルの付いていない未知データを読み込むことを想定しています。

サンプルとして用意しているiris_test.csvから削除した正解ラベルは以下の通りです。
learning.pyを実行した後にprediction.pyを実行して以下を得ることができれば成功です。

kind  
0: setosa  
0  
0  
0  
0  
0  
1: versicolor  
1  
1  
1  
1  
2: virginica  
2  
2  
2  
2  
